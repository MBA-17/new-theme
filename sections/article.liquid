{{ 'article.css' | asset_url | stylesheet_tag }}
<article class="main-article" style="--article-bg:{{ settings.background_color }}; --article-text:{{ settings.foreground_color }};">
  {% for block in section.blocks %}
  {% case block.type %}

   {% when 'featured_image' %}

      {% if section.settings.enabled_image %}
        {% if article.image %}
         <div class="article-image-wrapper image-{{ block.settings.image_height }}">
           {{ article.image | image_url: width: 1500 | image_tag: class: 'article-image' }}
         </div>

         {% else %}
          {% assign placeholder_image = 'lifestyle-2' %}
          <div class="article-image-wrapper image-{{ block.settings.image_height }}">
           {{ placeholder_image | placeholder_svg_tag: "article-image-wrapper"}}
         </div>

        {% endif %}
      {% endif %}

   {% when 'title' %}
      
      <header class="article-head title-align-{{ block.settings.title_align }}">

            {% if section.settings.enabled_title %}
             <h1 class="title">{{ article.title | escape }}</h1>
            {% endif %}

          <div class="article-meta">
            {% if section.settings.enabled_date %}
              <span class="meta-item">
                <svg class="meta-ic" viewBox="0 0 24 24" width="16" height="16" aria-hidden="true" fill="currentColor"><path d="M7 2a1 1 0 0 1 1 1v1h8V3a1 1 0 1 1 2 0v1h1a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1V3a1 1 0 0 1 1-1Zm12 7H5v10h14V9Z"/></svg>
                {{- article.published_at | time_tag: format: 'date' -}}
              </span>
            {% endif %}

            {% if section.settings.enabled_auth %}
              <span class="meta-item author-block">
                {% if section.settings.author_icon != blank %}
                 <img 
                    src="{{ section.settings.author_icon | image_url: width: 48 }}" 
                    srcset="
                      {{ section.settings.author_icon | image_url: width: 48 }} 1x,
                      {{ section.settings.author_icon | image_url: width: 96 }} 2x,
                      {{ section.settings.author_icon | image_url: width: 144 }} 3x
                    "
                    alt="{{ section.settings.author_name | escape }}" 
                    class="author-icon"
                    width="24" height="24"
                    loading="lazy"
                  >
                {% endif %}
                {{ article.author }}
              </span>
            {% endif %}

          </div>
      </header>

   {% when 'content' %}

      <div class="main-content {% if block.settings.enable_dropcap %}dropcap{% endif %}">
        {{ article.content }}
      </div>

   {% when 'share' %}
      {% assign share_url = shop.url | append: article.url %}
      {% assign share_title = article.title | url_param_escape %}
      {% assign share_image = article.image | image_url: width: 1200 %}

  <div class="share-bar" style="--share-background:{{ block.settings.share_bg }}; --share-border:{{ block.settings.share_dc }}; --share-justify:{{ block.settings.share_alignment }};">
    <span class="share-label">{{ block.settings.share_label }}</span>

    <a class="share-btn fb" href="https://www.facebook.com/sharer/sharer.php?u={{ share_url | url_encode }}" target="_blank" rel="noopener" aria-label="Share on Facebook">F</a>

    <a class="share-btn tw" href="https://twitter.com/intent/tweet?url={{ share_url | url_encode }}&text={{ share_title }}" target="_blank" rel="noopener" aria-label="Share on X">X</a>

    <a class="share-btn li" href="https://www.linkedin.com/sharing/share-offsite/?url={{ share_url | url_encode }}" target="_blank" rel="noopener" aria-label="Share on LinkedIn">in</a>

    {% if article.image %}
      <a class="share-btn pn" href="https://pinterest.com/pin/create/button/?url={{ share_url | url_encode }}&media={{ share_image | url_encode }}&description={{ share_title }}" target="_blank" rel="noopener" aria-label="Share on Pinterest">P</a>
    {% endif %}

    <button type="button" class="share-btn copy" data-share="{{ share_url }}" aria-label="Copy link">â§‰</button>
  </div>

   {% else %}
     
  {% endcase %}

  {% endfor %}


  {% comment %} {% if blog.comments_enabled? %}
    <div class="article_comments_wrapper" style="--comment-bg:{{ settings.background_color }} --comment-text:{{ settings.foreground_color }}">  
     <h2>{{ 'blog.article_comments' | t }}</h2>

     <div id="comments">
      {% paginate article.comments by 10 %}
      {% for comment in article.comments %}
        <div>
          <p>{{ comment.author }}</p>
          <p>
            {{- comment.created_at | time_tag: format: 'date' -}}
          </p>
          <p>{{ comment.content }}</p>
        </div>
      {% endfor %}

      {{ paginate | default_pagination: anchor: 'comments' }}
      {% endpaginate %}
     </div>

      {% form 'new_comment', article %}
       <h2>{{ 'blog.comment_form_title' | t }}</h2>

       {{ form.errors | default_errors }}

        <div class="comments-field">
          <div>
            <label for="author">{{ 'blog.comment_form_name' | t }}</label>
            <input type="text" name="comment[author]" id="author" value="{{ form.author }}" required>
          </div>

          <div>
            <label for="email">{{ 'blog.comment_form_email' | t }}</label>
            <input type="email" name="comment[email]" id="email" value="{{ form.email }}" required>
          </div>

          <div>
            <label for="body">{{ 'blog.comment_form_body' | t }}</label>
            <textarea name="comment[body]" id="body" required>{{ form.body }}</textarea>
          </div>
        </div> 

        <input type="submit" value="{{ 'blog.comment_form_submit' | t }}">
      {% endform %}
    </div>
  {% endif %} {% endcomment %}

  {% if blog.comments_enabled? %}
   <div class="article_comments_wrapper">
     <h2>{{ 'blog.article_comments' | t }}</h2>

     {% if article.comments_count > 0 %}
      <div id="comments">
        {% paginate article.comments by 5 %}
          {% for comment in article.comments %}
            <div class="article-comment">
              <p class="comment-author">{{ comment.author }}</p>
              <p class="comment-date">
                {{- comment.created_at | time_tag: format: 'date' -}}
              </p>
              <div class="comment-content">{{ comment.content }}</div>
            </div>
          {% endfor %}
    
          {{ paginate | default_pagination: anchor: 'comments' }}
        {% endpaginate %}
      </div>
    {% endif %}

    {% form 'new_comment', article %}
      <h2>{{ 'blog.comment_form_title' | t }}</h2>

      {{ form.errors | default_errors }}

      <div class="comments-field">
        <div>
          <label for="author">{{ 'blog.comment_form_name' | t }}</label>
          <input type="text" name="comment[author]" id="author" value="{{ form.author }}" required>
        </div>

        <div>
          <label for="email">{{ 'blog.comment_form_email' | t }}</label>
          <input type="email" name="comment[email]" id="email" value="{{ form.email }}" required>
        </div>

        <div>
          <label for="body">{{ 'blog.comment_form_body' | t }}</label>
          <textarea name="comment[body]" id="body" required>{{ form.body }}</textarea>
        </div>
      </div> 

      <input type="submit" class="comment-form-submit" value="{{ 'blog.comment_form_submit' | t }}">
    {% endform %}
  </div>
{% endif %}

</article>

<style>
  .article_comments_wrapper {
    margin-top: 40px;
    padding: 20px;
    background-color: {{ section.settings.wrapper_bg_color }};
  }

  .article_comments_wrapper h2 {
    color: {{ section.settings.heading_color }};
    font-size: {{ section.settings.heading_font_size }}px;
    margin-bottom: 20px;
    font-weight: 600;
  }

  /* Individual Comment Styling */
  .article-comment {
    padding: 15px;
    margin-bottom: 15px;
    border: 1px solid {{ section.settings.comment_border_color }};
    background-color: {{ section.settings.comment_bg_color }};
    border-radius: {{ section.settings.corner_radius }}px;
    {% if section.settings.enable_box_shadow %}
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      transition: box-shadow 0.3s ease;
    {% endif %}
  }

  {% if section.settings.enable_box_shadow %}
  .article-comment:hover {
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  {% endif %}

  .article_comments_wrapper .article-comment .comment-author {
    font-weight: bold;
    margin-bottom: 5px;
    color: {{ section.settings.author_name_color }};
  }

  .article_comments_wrapper .article-comment .comment-date {
    font-size: 12px;
    color: {{ section.settings.body_text_color | color_modify: 'alpha', 0.75 }};
    margin-bottom: 10px;
  }
  
  .article_comments_wrapper .article-comment .comment-content {
    color: {{ section.settings.body_text_color }};
  }

  .comments-field label {
    margin-bottom: 5px;
    font-weight: 500;
    color: {{ section.settings.body_text_color }};
  }

  .comments-field input[type="text"],
  .comments-field input[type="email"],
  .comments-field textarea {
    padding: 10px;
    border: 1px solid {{ section.settings.comment_border_color }};
    border-radius: {{ section.settings.corner_radius }}px;
    font-size: 16px;
    width: 100%;
    box-sizing: border-box;
    background-color: {{ section.settings.comment_bg_color }};
    color: {{ section.settings.body_text_color }};
  }

  /* Submit Button Styling -- CORRECTED SELECTOR */
  .article_comments_wrapper .comment-form-submit {
    background-color: {{ section.settings.button_bg_color }};
    color: {{ section.settings.button_text_color }};
    padding: 15px 60px;
    border: none;
    border-radius: {{ section.settings.corner_radius }}px;
    cursor: pointer;
    font-size: 16px;
    
    transition: background-color 0.3s ease;
    margin-top: 20px;
  }

  /* CORRECTED HOVER STATE SELECTOR */
  .article_comments_wrapper .comment-form-submit:hover {
    background-color: {{ section.settings.button_bg_color | color_darken: 10 }};
  }

  /* Pagination Styling */
  .pagination a, .pagination span {
    padding: 8px 12px;
    margin: 0 4px;
    border: 1px solid {{ section.settings.comment_border_color }};
    text-decoration: none;
    color: {{ section.settings.author_name_color }};
    border-radius: {{ section.settings.corner_radius }}px;
    transition: background-color 0.3s ease, color 0.3s ease;
  }

  .pagination .current {
    background-color: {{ section.settings.author_name_color }};
    color: {{ section.settings.comment_bg_color }};
    border-color: {{ section.settings.author_name_color }};
  }

  .pagination a:hover {
    background-color: {{ section.settings.comment_border_color }};
  }
</style>

{% schema %}
{
  "name": "t:general.article",
  "settings": [
    {
      "type": "header",
      "content": "Article Meta Settings"
    },
    {
      "type": "checkbox",
      "id": "enabled_image",
      "label": "Show Image",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enabled_auth",
      "label": "Show Author",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "author_icon",
      "label": "Author icon"
    },
    {
      "type": "checkbox",
      "id": "enabled_date",
      "label": "Show Date",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enabled_title",
      "label": "Show Title",
      "default": false
    },
    {
      "type": "header",
      "content": "Article Comment"
    },
    {
      "type": "color",
      "id": "wrapper_bg_color",
      "label": "Wrapper Background Color",
      "default": "#f9f9f9"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#111111"
    },
    {
      "type": "color",
      "id": "comment_bg_color",
      "label": "Comment Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "comment_border_color",
      "label": "Comment Border Color",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "author_name_color",
      "label": "Author Name & Link Color",
      "default": "#000"
    },
    {
      "type": "color",
      "id": "body_text_color",
      "label": "Body Text Color",
      "default": "#333333"
    },
    {
      "type": "header",
      "content": "Button Colors"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Button Background",
      "default": "#000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button Text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Typography & Style"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "min": 18,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Heading Font Size",
      "default": 24
    },
    {
      "type": "range",
      "id": "corner_radius",
      "min": 0,
      "max": 25,
      "step": 1,
      "unit": "px",
      "label": "Corner Radius",
      "info": "Applies to comment cards, input fields, and buttons.",
      "default": 8
    },
    {
      "type": "checkbox",
      "id": "enable_box_shadow",
      "label": "Enable Box Shadow on Comments",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "featured_image",
      "name": "Featured Image",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "image_height",
          "options": [
            {
              "value": "small",
              "label": "Small"
            },
            {
              "value": "medium",
              "label": "Medium"
            },
            {
              "value": "large",
              "label": "Large"
            }
          ],
          "default": "small",
          "label": "Set Image Height"
        }
      ]
    },
    {
      "type": "title",
      "name": "Title",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "title_align",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            },
          ],
          "label": "Title Align"
        }
      ]
    },
    {
      "type": "content",
      "name": "Content",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "enable_dropcap",
          "label": "Show DropCap",
          "default": false
        }
      ]
    },
    {
      "type": "share",
      "name": "Share",
      "limit": 2,
      "settings": [
        {
          "type": "text",
          "id": "share_label",
          "label": "Text",
          "default": "Share Button"
        },
        {
          "type": "color",
          "id": "share_bg",
          "label": "Share Bar Background",
          "default": "#f7f7f8"
        },
        {
          "type": "color",
          "id": "share_dc",
          "label": "Share Bar Border",
          "default": "#eee"
        },
        {
          "type": "select",
          "id": "share_alignment",
          "label": "Share Bar Alignment",
          "options": [
            {
              "value": "flex-start",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "flex-end",
              "label": "Right"
            },
            {
              "value": "space-between",
              "label": "Space Between"
            },
            {
              "value": "space-around",
              "label": "Space Around"
            },
            {
              "value": "space-evenly",
              "label": "Space Evenly"
            }
          ],
          "default": "flex-start"
        }
      ]
    }
  ]
}
{% endschema %}
